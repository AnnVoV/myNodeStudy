<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>tourist car</title>
  <link href="vendor/bootstrap/css/bootstrap-theme.css" rel="stylesheet" type="text/css" />
  <link href="vendor/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css" />
  <script src="js/jquery-1.11.2.js" type="text/javascript"></script>
  <style>
    html,body {
      width:100%;
    }
    .m-header {
      width:100%;
    }
    .m-header img {
      float:left;
      margin-left:200px;
    }
    .m-header h1 {
      float:left;
      height:186px;
      line-height:286px;
      margin-left:100px;
    }
    .m-header:after {
      content:'';
      display: block;
      clear:both;
    }
    .m-content {
      width:998px;/* 一般中间容器的宽度设置为998px 或者1080px */
      margin:0px auto;
    }
    .m-input {
      width:70px;
    }
    .m-hide {
      display: none;
    }
    .m-show {
      display: block;
    }
    .bg-success {
      width:400px;
      height:60px;
      line-height:60px;
      text-align: center;
      margin:0px auto;
      border-radius: 10px;
    }
    table {
      margin-bottom:50px;
    }
  </style>
</head>
<body>
  <div class="m-header">
    <img src="img/logo.png"/>
    <h1>travelling list</h1>
  </div>
  {{{body}}}
  <div class="m-footer">
  </div>

  <script>
  $(function(){
    /*var jqDom = {
      order:$('.j-order')
    }
    jqDom.order.on('click',function(){
      var promise = $.ajax({
        url:'/shoppingcar',
        data:{name:'ann',age:23}
      });
      //$.ajax() 操作完成以后如果是低于1.5的jQuery返回的是XHR,没法进行链式操作
      //如果高于1.5版本,返回的是deferred 对象
      promise
        .done(successFunction)
        .fail(errorFunction);

      function successFunction(){
        console.log('ajax data success....');
      }
      function errorFunction(){
        console.log('ajax data error.....');
      }
    });*/
    var jqDom = {
      order:$('.j-order')
    };

    var controller = {
      initial:function(){
        var pointer = this;
        jqDom.order.on('click',function(){
          var data = model.setData($(this));
          model.refreshData(data.location,data.size,data.price);
          pointer.ajaxRequest();
        });
      },
      ajaxRequest:function(){
        var promise = $.ajax(
          {
            url:'/shoppingcar',
            data:model.data
          }
        );

        promise.done(successFunc);
        promise.fail(errorFunc);

        var successFunc = function(){
          console.log('success');
        };
        var errorFunc = function(){
          console.log('error');
        };
      }
    };

    var view = {
    };

    var model = {
      data:'',
      refreshData:function(loca,size,price){
        this.data = {
          location:loca,
          size:size,
          price:price
        };
      },
      setData:function($elm){
        var $row = $elm.parent().parent(),
            location = $row.find('.j-place').html(),
            size = $row.find('.j-size').val(),
            price = $row.find('.j-price').html();

        return {
          location:location,
          size:size,
          price:price
        };
      }
    };

    //入口脚本
    var main = function(){
      controller.initial();
    };

    main();


  });

</script>
</body>
</html>

